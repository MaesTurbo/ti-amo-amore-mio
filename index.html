<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Ti Amo Amore Mio</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: black;
    }

    canvas {
      display: block;
    }

    h1 {
      position: absolute;
      top: 20px;
      width: 100%;
      text-align: center;
      font-size: 4em;
      font-family: 'Arial', sans-serif;
      font-weight: bold;
      z-index: 10;
      color: red;
      text-shadow: 2px 2px 10px white;
      animation: glow 3s infinite ease-in-out;
    }

    @keyframes glow {
      0% { color: red; text-shadow: 0 0 5px red; }
      25% { color: pink; text-shadow: 0 0 10px pink; }
      50% { color: orange; text-shadow: 0 0 20px orange; }
      75% { color: yellow; text-shadow: 0 0 15px yellow; }
      100% { color: red; text-shadow: 0 0 5px red; }
    }

    .heart {
      position: absolute;
      font-size: 20px;
      color: red;
      animation: float 6s infinite ease-in-out;
    }

    @keyframes float {
      0% {
        transform: translateY(0) scale(1);
        opacity: 1;
      }
      100% {
        transform: translateY(-100vh) scale(1.5);
        opacity: 0;
      }
    }
  </style>
</head>
<body>
  <h1>TI AMO AMORE MIO</h1>
  <canvas id="canvas"></canvas>

  <!-- Musica romantica -->
  <audio autoplay loop id="bgMusic">
    <source src="https://www.bensound.com/bensound-music/bensound-romantic.mp3" type="audio/mpeg" />
  </audio>

  <script>
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let particles = [];
    let imageData;
    let imgLoaded = false;
    const explosionRadius = 4;

    const img = new Image();
    img.src = "https://raw.githubusercontent.com/MaesTurbo/ti-amo-amore-mio/refs/heads/main/IMG-20200415-WA0007.jpg";
    img.crossOrigin = "anonymous";

    img.onload = () => {
      const offCanvas = document.createElement("canvas");
      const offCtx = offCanvas.getContext("2d");
      offCanvas.width = canvas.width;
      offCanvas.height = canvas.height;

      const aspectRatio = img.width / img.height;
      const imgWidth = canvas.width * 0.6;
      const imgHeight = imgWidth / aspectRatio;
      offCtx.drawImage(img, (canvas.width - imgWidth) / 2, (canvas.height - imgHeight) / 2, imgWidth, imgHeight);
      imageData = offCtx.getImageData(0, 0, canvas.width, canvas.height);
      imgLoaded = true;
    };

    class Particle {
      constructor(x, y, color) {
        this.x = x;
        this.y = 0;
        this.targetY = y;
        this.color = color;
        this.size = 1.5 + Math.random();
        this.speed = 2 + Math.random() * 2;
      }

      update() {
        if (this.y < this.targetY) {
          this.y += this.speed;
        }
      }

      draw() {
        ctx.fillStyle = this.color;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    function createParticlesFromImage() {
      if (!imgLoaded || !imageData) return;
      particles = [];
      for (let y = 0; y < imageData.height; y += 6) {
        for (let x = 0; x < imageData.width; x += 6) {
          const index = (y * imageData.width + x) * 4;
          const r = imageData.data[index];
          const g = imageData.data[index + 1];
          const b = imageData.data[index + 2];
          const a = imageData.data[index + 3];
          if (a > 100) {
            const color = `rgb(${r}, ${g}, ${b})`;
            if (Math.random() < 0.3) { // sparsi e casuali
              particles.push(new Particle(x, y, color));
            }
          }
        }
      }
    }

    function animateParticles() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      particles.forEach(p => {
        p.update();
        p.draw();
      });
    }

    setInterval(() => {
      if (imgLoaded) createParticlesFromImage();
    }, 5000); // ogni 5 sec nuova "esplosione"

    function loop() {
      animateParticles();
      requestAnimationFrame(loop);
    }

    loop();

    // Cuori fluttuanti
    setInterval(() => {
      const heart = document.createElement("div");
      heart.className = "heart";
      heart.innerText = "❤️";
      heart.style.left = Math.random() * window.innerWidth + "px";
      heart.style.fontSize = (Math.random() * 30 + 10) + "px";
      heart.style.color = ["red", "pink", "lightblue", "yellow", "green"][Math.floor(Math.random() * 5)];
      heart.style.top = window.innerHeight + "px";
      document.body.appendChild(heart);
      setTimeout(() => {
        heart.remove();
      }, 6000);
    }, 300);
  </script>
</body>
</html>
