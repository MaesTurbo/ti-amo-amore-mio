<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Ti Amo Amore Mio</title>
  <style>
    html, body {
      margin: 0; padding: 0; overflow: hidden; background: black;
      height: 100vh; width: 100vw;
      font-family: Arial, sans-serif;
      user-select: none;
    }

    canvas {
      display: block;
      position: absolute;
      top: 0; left: 0;
      z-index: 0;
    }

    h1 {
      position: absolute;
      top: 20px;
      width: 100%;
      text-align: center;
      font-size: 4em;
      font-weight: bold;
      z-index: 10;
      color: red;
      text-shadow: 2px 2px 10px white;
      animation: glow 3s infinite ease-in-out;
    }

    @keyframes glow {
      0% { color: red; text-shadow: 0 0 5px red; }
      25% { color: pink; text-shadow: 0 0 10px pink; }
      50% { color: orange; text-shadow: 0 0 20px orange; }
      75% { color: yellow; text-shadow: 0 0 15px yellow; }
      100% { color: red; text-shadow: 0 0 5px red; }
    }

    .heart {
      position: absolute;
      font-size: 20px;
      animation: float 6s linear forwards;
      pointer-events: none;
      color: red;
    }

    @keyframes float {
      0% { transform: translateY(0); opacity: 1; }
      100% { transform: translateY(-200px); opacity: 0; }
    }

    #explodeBtn {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 10px 20px;
      font-size: 1.5em;
      background: red;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      z-index: 20;
      box-shadow: 0 0 10px white;
    }
  </style>
</head>
<body>
  <canvas id="canvas"></canvas>
  <h1>Ti Amo Amore Mio ‚ù§Ô∏è</h1>
  <button id="explodeBtn">Esplodi!</button>
  <audio id="bgm" loop autoplay volume="0.3">
    <source src="https://cdn.pixabay.com/audio/2023/03/26/audio_5c4fb6faae.mp3" type="audio/mp3">
  </audio>
  <audio id="explosion">
    <source src="https://cdn.pixabay.com/audio/2022/03/15/audio_a771cc9d3e.mp3" type="audio/mp3">
  </audio>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let width = canvas.width = window.innerWidth;
    let height = canvas.height = window.innerHeight;
    const pixelSize = 5;
    const hearts = ['‚ù§Ô∏è','üíñ','üíò','üíï','üíó','üíû'];

    let imageSrc = "https://raw.githubusercontent.com/MaesTurbo/ti-amo-amore-mio/refs/heads/main/bbb.jpg";
    let explosionImageSrc = "https://raw.githubusercontent.com/MaesTurbo/ti-amo-amore-mio/refs/heads/main/ccccc.jpg";

    let pixels = [];
    let imageData = null;
    let composing = true;

    const bgm = document.getElementById('bgm');
    const explosionSound = document.getElementById('explosion');

    const img = new Image();
    img.crossOrigin = "anonymous";
    img.src = imageSrc;

    function createHearts() {
      const heart = document.createElement('div');
      heart.className = 'heart';
      heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
      heart.style.left = Math.random() * width + 'px';
      heart.style.top = height + 'px';
      document.body.appendChild(heart);
      setTimeout(() => heart.remove(), 6000);
    }

    setInterval(createHearts, 300);

    function createParticles() {
      pixels = [];
      if (!imageData) return;
      for (let y = 0; y < imageData.height; y += pixelSize) {
        for (let x = 0; x < imageData.width; x += pixelSize) {
          const index = (y * imageData.width + x) * 4;
          const r = imageData.data[index];
          const g = imageData.data[index + 1];
          const b = imageData.data[index + 2];
          const a = imageData.data[index + 3];
          if (a > 128) {
            const dx = (width / 2 - imageData.width / 2) + x;
            const dy = -Math.random() * height;
            pixels.push({ x: dx, y: dy, tx: dx, ty: (height / 2 - imageData.height / 2) + y, r, g, b });
          }
        }
      }
    }

    function drawParticles() {
      ctx.clearRect(0, 0, width, height);
      for (let p of pixels) {
        ctx.fillStyle = `rgb(${p.r},${p.g},${p.b})`;
        ctx.fillRect(p.x, p.y, pixelSize, pixelSize);
        p.y += (p.ty - p.y) * 0.05;
        if (Math.abs(p.y - p.ty) < 1) p.y = p.ty;
      }
    }

    function animate() {
      drawParticles();
      requestAnimationFrame(animate);
    }

    img.onload = function() {
      const tempCanvas = document.createElement('canvas');
      const tempCtx = tempCanvas.getContext('2d');
      tempCanvas.width = img.width;
      tempCanvas.height = img.height;
      tempCtx.drawImage(img, 0, 0);
      imageData = tempCtx.getImageData(0, 0, img.width, img.height);
      createParticles();
      animate();
    };

    document.getElementById("explodeBtn").onclick = () => {
      composing = false;
      bgm.pause();
      explosionSound.play();
      ctx.clearRect(0, 0, width, height);
      for (let i = 0; i < 300; i++) {
        const emoji = document.createElement('div');
        emoji.className = 'heart';
        emoji.textContent = hearts[Math.floor(Math.random() * hearts.length)];
        emoji.style.fontSize = (Math.random() * 30 + 10) + 'px';
        emoji.style.left = Math.random() * width + 'px';
        emoji.style.top = Math.random() * height + 'px';
        document.body.appendChild(emoji);
        setTimeout(() => emoji.remove(), 3000);
      }
      const boomImg = new Image();
      boomImg.src = explosionImageSrc;
      boomImg.onload = () => {
        let scale = 0.1;
        const interval = setInterval(() => {
          ctx.clearRect(0, 0, width, height);
          let w = boomImg.width * scale;
          let h = boomImg.height * scale;
          ctx.drawImage(boomImg, width / 2 - w / 2, height / 2 - h / 2, w, h);
          scale += 0.05;
          if (scale > 2) {
            clearInterval(interval);
            setTimeout(() => {
              bgm.play();
              img.src = imageSrc;
            }, 3000);
          }
        }, 50);
      };
    };

    window.addEventListener('resize', () => {
      width = canvas.width = window.innerWidth;
      height = canvas.height = window.innerHeight;
    });
  </script>
</body>
</html>
